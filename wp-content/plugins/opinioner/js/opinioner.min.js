"use strict";!function(){tinymce.create('tinymce.plugins.opinioner_plugin',{init:function(e,n){var o="\n                <div id=\"insert-opinioner\">\n                    <p class=\"\">Your shortcode is: <code class=\"shortcode\">[opinioner id=\"\"]</code></p>\n                    <p class=\"help\">Select one of the existing votes.</p>\n                    <div class=\"search-wrapper\">\n                        <label>\n                            <span class=\"search-label\">Search</span>\n                            <input type=\"search\" id=\"opinioner-search\" class=\"opinioner-search-field\" autocomplete=\"off\">\n                            <span class=\"spinner\"></span>\n                        </label>\n                    </div>\n                    <div id=\"opinioner-search-results\" tabindex=\"0\">\n                        <ul></ul>\n                    </div>\n                </div>\n            ";e.addButton('opinioner',{title:'Insert Opinioner Vote',image:n+'/../images/icon.svg',onclick:function(){e.windowManager.open({title:'Insert Vote',width:500,height:400,body:[{type:'container',html:o}],buttons:[{text:'Insert Vote',classes:'btn primary',id:'insert-vote-btn',onclick:function(n){var o=e.selection.getContent(),i=jQuery('#insert-opinioner .shortcode').text(),t='';o?(t=o+i):(t=i);e.execCommand('mceInsertContent',0,t);e.windowManager.close()}},{text:'Close',id:'close-vote-btn',onclick:'close'}],onOpen:function(e){jQuery('#opinioner-search-results').addClass('loader');jQuery.ajax({url:opinioner_data.rest_url+'wp/v2/opinioner/?filter[posts_per_page]=42',dataType:'json'}).done(function(e){jQuery('#opinioner-search-results ul').empty();jQuery.each(e,function(e,n){jQuery('#opinioner-search-results ul').append("<li><input class=\"item-vote\" type=\"hidden\" value=\""+n.id+'">'+'<span class="item-title">'+n.title.rendered+'</span>'+'<span class="item-info">'+(new Date(n.date).toLocaleDateString())+'</span>'+'</li>')})}).fail(function(e){console.log('error!');console.log(e)}).always(function(){jQuery('#opinioner-search-results').removeClass('loader')});jQuery('#opinioner-search').on('keyup paste',function(){var e=jQuery(this).val().toLowerCase();e.length>1?jQuery('#opinioner-search-results ul li').each(function(n){~jQuery(this).find('.item-title').text().toLowerCase().indexOf(e)?jQuery(this).show():jQuery(this).hide()}):jQuery('#opinioner-search-results ul li').show()});jQuery('body').on('click','#opinioner-search-results ul li',function(){jQuery('#opinioner-search-results ul li').removeClass('selected');jQuery(this).addClass('selected');jQuery('#insert-opinioner .shortcode').html('[opinioner id="'+jQuery(this).find('.item-vote').val()+'"]')})}})}})},createControl:function(e,n){return null},getInfo:function(){return{longname:'Opinioner',author:'Merkulove',version:'1.0.0'}}});tinymce.PluginManager.add('opinioner_plugin',tinymce.plugins.opinioner_plugin)}()