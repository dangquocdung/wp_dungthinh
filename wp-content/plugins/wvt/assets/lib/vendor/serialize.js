function serialize(r){"use strict";var e,n,t,a="",i=0,o=function(r){var e,n,t,a,i=typeof r;if("object"===i&&!r)return"null";if("object"===i){if(!r.constructor)return"object";for(n in(e=(t=r.constructor.toString()).match(/(\w+)\(/))&&(t=e[1].toLowerCase()),a=["boolean","number","string","array"])if(t==a[n]){i=a[n];break}}return i},c=o(r);switch(c){case"function":e="";break;case"boolean":e="b:"+(r?"1":"0");break;case"number":e=(Math.round(r)==r?"i":"d")+":"+r;break;case"string":e="s:"+function(r){var e=0,n=0,t=r.length,a="";for(n=0;n<t;n++)e+=(a=r.charCodeAt(n))<128?1:a<2048?2:3;return e}(r)+':"'+r+'"';break;case"array":case"object":for(n in e="a",r)if(r.hasOwnProperty(n)){if("function"===o(r[n]))continue;t=n.match(/^[0-9]+$/)?parseInt(n,10):n,a+=this.serialize(t)+this.serialize(r[n]),i++}e+=":"+i+":{"+a+"}";break;case"undefined":default:e="N"}return"object"!==c&&"array"!==c&&("string"==c&&-1!=e.indexOf("}")||(e+=";")),e}function unserialize(r){"use strict";var e=this,n=function(r){var e=r.charCodeAt(0);return e<128?0:e<2048?1:2},t=function(r,n,t,a){throw new e.window[r](n,t,a)},a=function(r,e,n){for(var a=2,i=[],o=r.slice(e,e+1);o!=n;)a+e>r.length&&t("Error","Invalid"),i.push(o),o=r.slice(e+(a-1),e+a),a+=1;return[i.length,i.join("")]},i=function(r,e){var o,c,s,u,f,l,b,h,d,k,p,w,g,v,y,j,I,m,z=0,C=function(r){return r};switch(e||(e=0),c=e+2,o=r.slice(e,e+1).toLowerCase()){case"i":C=function(r){return parseInt(r,10)},z=(d=a(r,c,";"))[0],h=d[1],c+=z+1;break;case"b":C=function(r){return 0!==parseInt(r,10)},z=(d=a(r,c,";"))[0],h=d[1],c+=z+1;break;case"d":C=function(r){return parseFloat(r)},z=(d=a(r,c,";"))[0],h=d[1],c+=z+1;break;case"n":h=null;break;case"s":z=(k=a(r,c,":"))[0],p=k[1],z=(d=function(r,e,t){var a,i,o;for(o=[],a=0;a<t;a++)i=r.slice(e+(a-1),e+a),o.push(i),t-=n(i);return[o.length,o.join("")]}(r,(c+=z+2)+1,parseInt(p,10)))[0],h=d[1],c+=z+2,z!=parseInt(p,10)&&z!=h.length&&t("SyntaxError","String length mismatch");break;case"a":for(h={},z=(s=a(r,c,":"))[0],u=s[1],c+=z+2,l=parseInt(u,10),f=!0,w=0;w<l;w++)y=(v=i(r,c))[1],g=v[2],I=(j=i(r,c+=y))[1],m=j[2],c+=I,g!==w&&(f=!1),h[g]=m;if(f){for(b=new Array(l),w=0;w<l;w++)b[w]=h[w];h=b}c+=1;break;default:t("SyntaxError","Unknown / Unhandled data type(s): "+o)}return[o,c-e,C(h)]};return i(r+"",0)[2]}