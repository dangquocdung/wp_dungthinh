var G5Portfolio=G5Portfolio||{};(function(s){"use strict";G5Portfolio={ajax_call:false,cache:{},init:function(){this.lightBoxGallery();this.categoryDropdown()},addCache:function(e,a){if(typeof this.cache==="undefined"){this.cache={}}if(typeof this.cache[e]!=="undefined")return;this.cache[e]=a},getCache:function(e){if(typeof this.cache!=="undefined"&&typeof this.cache[e]!=="undefined"){return this.cache[e]}return""},lightBoxGallery:function(){var n=this;s(document).on("click","[data-g5portfolio-light-box]",function(e){e.preventDefault();if(n.ajax_call!==false){return false}var a=s(this),o=a.closest(".g5core__post-featured"),i=parseInt(a.data("id"),10),t=a.data("nonce"),r="g5portfolio__gallery_"+i,l=n.getCache(r);o.addClass("active");a.addClass("spinner");if(l!==""){n.openGallery(l);n.ajax_call=false;a.removeClass("spinner");o.removeClass("active")}else{n.ajax_call=s.ajax({url:g5portfolio_variable.ajax_url,data:{action:"g5portfolio_light_box_gallery",id:i,_ajax_nonce:t},success:function(e){n.ajax_call=false;a.removeClass("spinner");o.removeClass("active");if(e.success){n.addCache(r,e.data);n.openGallery(e.data)}},error:function(e){console.log(e);n.ajax_call=false;a.removeClass("spinner");o.removeClass("active")}})}})},openGallery:function(e){if(typeof s().magnificPopup==="function"){var a=e.type==="video"?"iframe":"image";s.magnificPopup.open({type:a,mainClass:"mfp-zoom-in",closeOnBgClick:true,closeBtnInside:false,midClick:true,removalDelay:500,items:e.items,gallery:{enabled:true},callbacks:{beforeOpen:function(){switch(this.st.type){case"image":this.st.image.markup=this.st.image.markup.replace("mfp-figure","mfp-figure mfp-with-anim");break;case"iframe":this.st.iframe.markup=this.st.iframe.markup.replace("mfp-iframe-scaler","mfp-iframe-scaler mfp-with-anim");break}},change:function(){var e=this;if(this.isOpen){this.wrap.removeClass("mfp-ready");setTimeout(function(){e.wrap.addClass("mfp-ready")},10)}}}})}},categoryDropdown:function(){s(".g5portfolio__dropdown_categories").on("change",function(){if(s(this).val()!==""){var e="";var a=g5portfolio_variable.home_url;if(a.indexOf("?")>0){e=a+"&portfolio_category="+s(this).val()}else{e=a+"?portfolio_category="+s(this).val()}location.href=e}else{location.href=g5portfolio_variable.archive_url}});if(s().select2){s(".g5portfolio__dropdown_categories").select2({placeholder:g5portfolio_variable.localization.dropdown_categories_placeholder,minimumResultsForSearch:5,width:"100%",allowClear:true,language:{noResults:function(){return g5portfolio_variable.localization.dropdown_categories_noResults}}})}}};s(document).ready(function(){G5Portfolio.init()})})(jQuery);